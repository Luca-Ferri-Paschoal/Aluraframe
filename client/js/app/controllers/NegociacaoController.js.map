{"version":3,"file":"NegociacaoController.js","names":["NegociacaoController","pega","document","querySelector","bind","Bind","ListaNegociacoes","NegociacoesView","Mensagem","MensagemView","NegociacaoService","event","preventDefault","negociacao","cadastra","then","mensagem","adiciona","texto","catch","erro","apaga","esvazia","coluna","criterio","ordenaPor","lista","negociacoes","forEach","console","log","setInterval","importa","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","zero","toFixed","focus"],"sources":["../../app-es6/controllers/NegociacaoController.js"],"sourcesContent":["class NegociacaoController {\r\n    #inputData;\r\n    #inputQuantidade;\r\n    #inputValor;\r\n    #listaNegociacoes;\r\n    #mensagem;\r\n    #colunaAnterior;\r\n    #service;\r\n\r\n    constructor() {\r\n        const pega = document.querySelector.bind(document);\r\n\r\n        this.#inputData = pega('#data');\r\n        this.#inputQuantidade = pega('#quantidade');\r\n        this.#inputValor = pega('#valor');\r\n\r\n        this.#listaNegociacoes = new Bind(\r\n            new ListaNegociacoes(),\r\n            new NegociacoesView(pega('#negociacoesView')),\r\n            'adiciona', 'esvazia', 'ordenaPor',\r\n        );\r\n\r\n        this.#mensagem = new Bind(\r\n            new Mensagem(),\r\n            new MensagemView(pega('#mensagemView')),\r\n            'texto',\r\n        );\r\n\r\n        this.#colunaAnterior = null;\r\n        this.#service = new NegociacaoService();\r\n\r\n        this.#init();\r\n    }\r\n\r\n    #init() {\r\n        this.#service\r\n        .lista()\r\n        .then(negociacoes =>\r\n            negociacoes.forEach(negociacao =>\r\n            this.#listaNegociacoes.adiciona(negociacao))\r\n        )\r\n        .catch(erro => {\r\n            console.log(erro);\r\n            this.#mensagem.texto = erro;\r\n        });\r\n        \r\n        setInterval(() => {\r\n            this.#importaNegociacoes();\r\n        }\r\n        , 3000);\r\n    }\r\n\r\n    adiciona(event) {\r\n        event.preventDefault();\r\n        const negociacao = this.#criaNegociacao();\r\n\r\n        this.#service\r\n        .cadastra(negociacao)\r\n        .then(mensagem => {\r\n            this.#listaNegociacoes.adiciona(negociacao);\r\n            this.#mensagem.texto = mensagem;\r\n            this.#limpaCampos();\r\n        })\r\n        .catch(erro => this.#mensagem.texto = erro);\r\n    }\r\n\r\n    #importaNegociacoes() {\r\n        this.#service.importa(this.#listaNegociacoes.negociacoes)\r\n        .then(negociacoes => negociacoes.forEach(negociacao => {\r\n            this.#listaNegociacoes.adiciona(negociacao)\r\n        }))\r\n        .catch(erro => this.#mensagem.texto = erro);\r\n    }\r\n\r\n    apagaLista() {\r\n        this.#service\r\n        .apaga()\r\n        .then(mensagem => {\r\n            this.#listaNegociacoes.esvazia();\r\n            this.#mensagem.texto = mensagem;\r\n        })\r\n        .catch(erro => this.#mensagem.texto = erro);\r\n    }\r\n\r\n    ordenaLista(coluna) {  \r\n        let criterio = null;\r\n\r\n        if (this.#colunaAnterior === coluna) {\r\n            this.#colunaAnterior = null;\r\n            criterio = 'descrescente';\r\n        } else {\r\n            this.#colunaAnterior = coluna;\r\n            criterio = 'crescente';\r\n        }\r\n\r\n        this.#listaNegociacoes.ordenaPor(coluna, criterio);\r\n    }\r\n\r\n    #criaNegociacao() {\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this.#inputData.value),\r\n            parseInt(this.#inputQuantidade.value),\r\n            parseFloat(this.#inputValor.value),\r\n        );\r\n    }\r\n\r\n    #limpaCampos() {\r\n        let zero = 0;\r\n\r\n        this.#inputData.value = '';\r\n        this.#inputQuantidade.value = 1;\r\n        this.#inputValor.value = zero.toFixed(1);\r\n\r\n        this.#inputData.focus();\r\n    }\r\n}\r\n"],"mappings":"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"}