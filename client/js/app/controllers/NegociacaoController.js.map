{"version":3,"file":"NegociacaoController.js","names":["lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","console","log","texto","setInterval","importa","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","zero","toFixed","focus","currentInstance","negociacaoController","ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","Bind","NegociacaoController","pega","document","querySelector","bind","event","preventDefault","cadastra","mensagem","apaga","esvazia","coluna","criterio","ordenaPor"],"sources":["../../app-es6/controllers/NegociacaoController.js"],"sourcesContent":["import { Negociacao } from './../models/Negociacao.js';\r\nimport { ListaNegociacoes } from './../models/ListaNegociacoes.js';\r\nimport { Mensagem } from './../models/Mensagem.js';\r\nimport { NegociacoesView } from './../views/NegociacoesView.js';\r\nimport { MensagemView } from './../views/MensagemView.js';\r\nimport { NegociacaoService } from './../services/NegociacaoService.js';\r\nimport { DateHelper } from './../helpers/DateHelper.js';\r\nimport { Bind } from './../helpers/Bind.js';\r\n\r\nclass NegociacaoController {\r\n    #inputData;\r\n    #inputQuantidade;\r\n    #inputValor;\r\n    #listaNegociacoes;\r\n    #mensagem;\r\n    #colunaAnterior;\r\n    #service;\r\n\r\n    constructor() {\r\n        const pega = document.querySelector.bind(document);\r\n\r\n        this.#inputData = pega('#data');\r\n        this.#inputQuantidade = pega('#quantidade');\r\n        this.#inputValor = pega('#valor');\r\n\r\n        this.#listaNegociacoes = new Bind(\r\n            new ListaNegociacoes(),\r\n            new NegociacoesView(pega('#negociacoesView')),\r\n            'adiciona', 'esvazia', 'ordenaPor',\r\n        );\r\n\r\n        this.#mensagem = new Bind(\r\n            new Mensagem(),\r\n            new MensagemView(pega('#mensagemView')),\r\n            'texto',\r\n        );\r\n\r\n        this.#colunaAnterior = null;\r\n        this.#service = new NegociacaoService();\r\n\r\n        this.#init();\r\n    }\r\n\r\n    #init() {\r\n        this.#service\r\n        .lista()\r\n        .then(negociacoes =>\r\n            negociacoes.forEach(negociacao =>\r\n            this.#listaNegociacoes.adiciona(negociacao))\r\n        )\r\n        .catch(erro => {\r\n            console.log(erro);\r\n            this.#mensagem.texto = erro;\r\n        });\r\n        \r\n        setInterval(() => {\r\n            this.#importaNegociacoes();\r\n        }\r\n        , 3000);\r\n    }\r\n\r\n    adiciona(event) {\r\n        event.preventDefault();\r\n        const negociacao = this.#criaNegociacao();\r\n\r\n        this.#service\r\n        .cadastra(negociacao)\r\n        .then(mensagem => {\r\n            this.#listaNegociacoes.adiciona(negociacao);\r\n            this.#mensagem.texto = mensagem;\r\n            this.#limpaCampos();\r\n        })\r\n        .catch(erro => this.#mensagem.texto = erro);\r\n    }\r\n\r\n    #importaNegociacoes() {\r\n        this.#service.importa(this.#listaNegociacoes.negociacoes)\r\n        .then(negociacoes => negociacoes.forEach(negociacao => {\r\n            this.#listaNegociacoes.adiciona(negociacao)\r\n        }))\r\n        .catch(erro => this.#mensagem.texto = erro);\r\n    }\r\n\r\n    apagaLista() {\r\n        this.#service\r\n        .apaga()\r\n        .then(mensagem => {\r\n            this.#listaNegociacoes.esvazia();\r\n            this.#mensagem.texto = mensagem;\r\n        })\r\n        .catch(erro => this.#mensagem.texto = erro);\r\n    }\r\n\r\n    ordenaLista(coluna) {  \r\n        let criterio = null;\r\n\r\n        if (this.#colunaAnterior === coluna) {\r\n            this.#colunaAnterior = null;\r\n            criterio = 'descrescente';\r\n        } else {\r\n            this.#colunaAnterior = coluna;\r\n            criterio = 'crescente';\r\n        }\r\n\r\n        this.#listaNegociacoes.ordenaPor(coluna, criterio);\r\n    }\r\n\r\n    #criaNegociacao() {\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this.#inputData.value),\r\n            parseInt(this.#inputQuantidade.value),\r\n            parseFloat(this.#inputValor.value),\r\n        );\r\n    }\r\n\r\n    #limpaCampos() {\r\n        let zero = 0;\r\n\r\n        this.#inputData.value = '';\r\n        this.#inputQuantidade.value = 1;\r\n        this.#inputValor.value = zero.toFixed(1);\r\n\r\n        this.#inputData.focus();\r\n    }\r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\n\r\nexport function currentInstance() {\r\n    return negociacaoController;\r\n}\r\n"],"mappings":"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"}