{"version":3,"file":"NegociacaoDao.js","names":["Negociacao","NegociacaoDao","connection","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","atributos","onsuccess","event","onerror","console","log","target","error","cursor","openCursor","listaNegociacoes","atual","result","dado","value","push","data","quantidade","valor","continue","clear"],"sources":["../../app-es6/dao/NegociacaoDao.js"],"sourcesContent":["import { Negociacao } from './../models/Negociacao.js';\r\n\r\nexport class NegociacaoDao {\r\n    #connectoin\r\n    #store;\r\n\r\n    constructor(connection) {\r\n        this.#connectoin = connection;\r\n        this.#store = 'negociacoes';;\r\n    }\r\n\r\n    adiciona(negociacao) {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            const request = this.#connectoin\r\n            .transaction([this.#store], 'readwrite')\r\n            .objectStore(this.#store)\r\n            .add(negociacao.atributos);\r\n\r\n            request.onsuccess = event => {\r\n                resolve('Negociação adcionada com sucesso.');\r\n            };\r\n\r\n            request.onerror = event => {\r\n                console.log(event.target.error);\r\n                reject('Não foi possível adicionar a negociação.');\r\n            };\r\n        });\r\n    }\r\n\r\n    listaTodos() {\r\n        return new Promise((resolve, reject) => {\r\n            const cursor = this.#connectoin\r\n            .transaction([this.#store], 'readwrite')\r\n            .objectStore(this.#store)\r\n            .openCursor();\r\n\r\n            const listaNegociacoes = [];\r\n\r\n            cursor.onsuccess = event => {\r\n                const atual = event.target.result;\r\n\r\n                if (atual !== null) {\r\n                    const dado = atual.value;\r\n\r\n                    listaNegociacoes.push(new Negociacao(dado.data, dado.quantidade, dado.valor));\r\n\r\n                    atual.continue();\r\n                } else {\r\n                    resolve(listaNegociacoes);\r\n                }\r\n            };\r\n\r\n            cursor.onerror = event => {\r\n                console.log(event.target.error);\r\n                reject('Não foi possível listar as negociações.');\r\n            };\r\n        })\r\n    }\r\n\r\n    apagaTodos() {\r\n        return new Promise((resolve, reject) => {\r\n            const request = this.#connectoin\r\n            .transaction([this.#store], 'readwrite')\r\n            .objectStore(this.#store)\r\n            .clear();\r\n\r\n            request.onsuccess = event => {\r\n                resolve('Negociações apagadas com sucesso.');\r\n            };\r\n\r\n            request.onerror = event => {\r\n                console.log(event.target.error);\r\n                reject('Não foi possível apagar as negociações');\r\n            };\r\n        });\r\n    }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAASA,U,uBAAAA,U;;;;;;+BAEIC,a;QAIT,uBAAYC,UAAZ,EAAwB;UAAA;;UAAA;YAAA;YAAA;UAAA;;UAAA;YAAA;YAAA;UAAA;;UACpB,yCAAmBA,UAAnB;;UACA,oCAAc,aAAd;;UAA4B;QAC/B;;;;iBAED,kBAASC,UAAT,EAAqB;YAAA;;YACjB,OAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;cAEpC,IAAMC,OAAO,GAAG,2BAAI,cAAJ,CACfC,WADe,CACH,uBAAC,KAAD,UADG,EACY,WADZ,EAEfC,WAFe,uBAEH,KAFG,WAGfC,GAHe,CAGXP,UAAU,CAACQ,SAHA,CAAhB;;cAKAJ,OAAO,CAACK,SAAR,GAAoB,UAAAC,KAAK,EAAI;gBACzBR,OAAO,CAAC,mCAAD,CAAP;cACH,CAFD;;cAIAE,OAAO,CAACO,OAAR,GAAkB,UAAAD,KAAK,EAAI;gBACvBE,OAAO,CAACC,GAAR,CAAYH,KAAK,CAACI,MAAN,CAAaC,KAAzB;gBACAZ,MAAM,CAAC,0CAAD,CAAN;cACH,CAHD;YAIH,CAfM,CAAP;UAgBH;;;iBAED,sBAAa;YAAA;;YACT,OAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;cACpC,IAAMa,MAAM,GAAG,4BAAI,cAAJ,CACdX,WADc,CACF,uBAAC,MAAD,UADE,EACa,WADb,EAEdC,WAFc,uBAEF,MAFE,WAGdW,UAHc,EAAf;;cAKA,IAAMC,gBAAgB,GAAG,EAAzB;;cAEAF,MAAM,CAACP,SAAP,GAAmB,UAAAC,KAAK,EAAI;gBACxB,IAAMS,KAAK,GAAGT,KAAK,CAACI,MAAN,CAAaM,MAA3B;;gBAEA,IAAID,KAAK,KAAK,IAAd,EAAoB;kBAChB,IAAME,IAAI,GAAGF,KAAK,CAACG,KAAnB;kBAEAJ,gBAAgB,CAACK,IAAjB,CAAsB,IAAI1B,UAAJ,CAAewB,IAAI,CAACG,IAApB,EAA0BH,IAAI,CAACI,UAA/B,EAA2CJ,IAAI,CAACK,KAAhD,CAAtB;kBAEAP,KAAK,CAACQ,QAAN;gBACH,CAND,MAMO;kBACHzB,OAAO,CAACgB,gBAAD,CAAP;gBACH;cACJ,CAZD;;cAcAF,MAAM,CAACL,OAAP,GAAiB,UAAAD,KAAK,EAAI;gBACtBE,OAAO,CAACC,GAAR,CAAYH,KAAK,CAACI,MAAN,CAAaC,KAAzB;gBACAZ,MAAM,CAAC,yCAAD,CAAN;cACH,CAHD;YAIH,CA1BM,CAAP;UA2BH;;;iBAED,sBAAa;YAAA;;YACT,OAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;cACpC,IAAMC,OAAO,GAAG,4BAAI,cAAJ,CACfC,WADe,CACH,uBAAC,MAAD,UADG,EACY,WADZ,EAEfC,WAFe,uBAEH,MAFG,WAGfsB,KAHe,EAAhB;;cAKAxB,OAAO,CAACK,SAAR,GAAoB,UAAAC,KAAK,EAAI;gBACzBR,OAAO,CAAC,mCAAD,CAAP;cACH,CAFD;;cAIAE,OAAO,CAACO,OAAR,GAAkB,UAAAD,KAAK,EAAI;gBACvBE,OAAO,CAACC,GAAR,CAAYH,KAAK,CAACI,MAAN,CAAaC,KAAzB;gBACAZ,MAAM,CAAC,wCAAD,CAAN;cACH,CAHD;YAIH,CAdM,CAAP;UAeH"}